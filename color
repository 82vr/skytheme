
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SkyThemeGUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = PlayerGui

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 300, 0, 400)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
MainFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 10)
UICorner.Parent = MainFrame

local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Size = UDim2.new(1, 0, 0, 40)
TitleBar.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
TitleBar.BorderSizePixel = 0
TitleBar.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 10)
TitleCorner.Parent = TitleBar

local TitleText = Instance.new("TextLabel")
TitleText.Name = "TitleText"
TitleText.Size = UDim2.new(1, -100, 1, 0)
TitleText.Position = UDim2.new(0, 10, 0, 0)
TitleText.BackgroundTransparency = 1
TitleText.Text = "Sky Themes"
TitleText.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleText.TextSize = 18
TitleText.Font = Enum.Font.GothamBold
TitleText.TextXAlignment = Enum.TextXAlignment.Left
TitleText.Parent = TitleBar

local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Position = UDim2.new(1, -35, 0, 5)
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
CloseButton.Text = ""
CloseButton.BorderSizePixel = 0
CloseButton.Parent = TitleBar

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 15)
CloseCorner.Parent = CloseButton

local CloseX = Instance.new("TextLabel")
CloseX.Name = "CloseX"
CloseX.Size = UDim2.new(1, 0, 1, 0)
CloseX.BackgroundTransparency = 1
CloseX.Text = "Ã—"
CloseX.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseX.TextSize = 20
CloseX.Font = Enum.Font.GothamBold
CloseX.Parent = CloseButton

local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Size = UDim2.new(1, -20, 1, -50)
ContentFrame.Position = UDim2.new(0, 10, 0, 45)
ContentFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
ContentFrame.BorderSizePixel = 0
ContentFrame.Parent = MainFrame

local ContentCorner = Instance.new("UICorner")
ContentCorner.CornerRadius = UDim.new(0, 8)
ContentCorner.Parent = ContentFrame

local ScrollFrame = Instance.new("ScrollingFrame")
ScrollFrame.Name = "ScrollFrame"
ScrollFrame.Size = UDim2.new(1, -10, 1, -10)
ScrollFrame.Position = UDim2.new(0, 5, 0, 5)
ScrollFrame.BackgroundTransparency = 1
ScrollFrame.BorderSizePixel = 0
ScrollFrame.ScrollBarThickness = 4
ScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
ScrollFrame.Parent = ContentFrame

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 10)
UIListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Parent = ScrollFrame

local UIPadding = Instance.new("UIPadding")
UIPadding.PaddingTop = UDim.new(0, 10)
UIPadding.PaddingBottom = UDim.new(0, 10)
UIPadding.Parent = ScrollFrame

local skyThemes = {
    "CakeUP Night Galaxy Planets", "Purple Space", "Galaxy Mountains",
    "Deep Space", "Nebula", "Night", "Alien Red",
    "Tropical", "Day Clouds", "Minecraft", "Anime Island", "Wide Street"
}

local function CreateThemeButton(theme)
    local Button = Instance.new("TextButton")
    Button.Name = theme .. "_Button"
    Button.Size = UDim2.new(1, -20, 0, 40)
    Button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    Button.Text = theme
    Button.TextColor3 = Color3.fromRGB(255, 255, 255)
    Button.TextSize = 14
    Button.Font = Enum.Font.Gotham
    Button.BorderSizePixel = 0
    Button.Parent = ScrollFrame

    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0, 6)
    ButtonCorner.Parent = Button

    Button.MouseButton1Click:Connect(function()
        print("Selected sky: " .. theme)

        local existingSky = game.Lighting:FindFirstChildOfClass("Sky")
        if existingSky then
            existingSky:Destroy()
        end

        local newSky = Instance.new("Sky")
        newSky.Parent = game.Lighting

        if theme == "CakeUP Night Galaxy Planets" then
            newSky.SkyboxUp = "rbxassetid://15983964246"
            newSky.SkyboxDn = "rbxassetid://15983966825"
            newSky.SkyboxLf = "rbxassetid://15983967420"
            newSky.SkyboxRt = "rbxassetid://15983966246"
            newSky.SkyboxFt = "rbxassetid://15983965025"
            newSky.SkyboxBk = "rbxassetid://15983968922"
        elseif theme == "Purple Space" then
            newSky.SkyboxUp = "rbxassetid://14543371676"
            newSky.SkyboxDn = "rbxassetid://14543358958"
            newSky.SkyboxLf = "rbxassetid://14543275895"
            newSky.SkyboxRt = "rbxassetid://14543280890"
            newSky.SkyboxFt = "rbxassetid://14543257810"
            newSky.SkyboxBk = "rbxassetid://14543264135"
        elseif theme == "Galaxy Mountains" then
            newSky.SkyboxUp = "rbxassetid://17103639457"
            newSky.SkyboxDn = "rbxassetid://17103622190"
            newSky.SkyboxLf = "rbxassetid://17103628153"
            newSky.SkyboxRt = "rbxassetid://17103636666"
            newSky.SkyboxFt = "rbxassetid://17103624898"
            newSky.SkyboxBk = "rbxassetid://17103618635"
        elseif theme == "Deep Space" then
            newSky.SkyboxUp = "rbxassetid://159248176"
            newSky.SkyboxDn = "rbxassetid://159248183"
            newSky.SkyboxLf = "rbxassetid://159248173"
            newSky.SkyboxRt = "rbxassetid://159248192"
            newSky.SkyboxFt = "rbxassetid://159248187"
            newSky.SkyboxBk = "rbxassetid://159248188"
        elseif theme == "Nebula" then
            newSky.SkyboxUp = "rbxassetid://13581450222"
            newSky.SkyboxDn = "rbxassetid://13581439832"
            newSky.SkyboxLf = "rbxassetid://13581443463"
            newSky.SkyboxRt = "rbxassetid://13581452875"
            newSky.SkyboxFt = "rbxassetid://13581447312"
            newSky.SkyboxBk = "rbxassetid://13581437029"
        elseif theme == "Night" then
            newSky.SkyboxUp = "rbxassetid://12064131"
            newSky.SkyboxDn = "rbxassetid://12064152"
            newSky.SkyboxLf = "rbxassetid://12063984"
            newSky.SkyboxRt = "rbxassetid://12064115"
            newSky.SkyboxFt = "rbxassetid://12064121"
            newSky.SkyboxBk = "rbxassetid://12064107"
        elseif theme == "Alien Red" then
            newSky.SkyboxUp = "rbxassetid://1014449"
            newSky.SkyboxDn = "rbxassetid://1012891"
            newSky.SkyboxLf = "rbxassetid://1012889"
            newSky.SkyboxRt = "rbxassetid://1012888"
            newSky.SkyboxFt = "rbxassetid://1012887"
            newSky.SkyboxBk = "rbxassetid://1012890"
        elseif theme == "Tropical" then
            newSky.SkyboxUp = "rbxassetid://169210149"
            newSky.SkyboxDn = "rbxassetid://169210108"
            newSky.SkyboxLf = "rbxassetid://169210133"
            newSky.SkyboxRt = "rbxassetid://169210143"
            newSky.SkyboxFt = "rbxassetid://169210121"
            newSky.SkyboxBk = "rbxassetid://169210090"
        elseif theme == "Day Clouds" then
            newSky.SkyboxUp = "rbxassetid://17480119200"
            newSky.SkyboxDn = "rbxassetid://17480112104"
            newSky.SkyboxLf = "rbxassetid://17480115228"
            newSky.SkyboxRt = "rbxassetid://17480116763"
            newSky.SkyboxFt = "rbxassetid://17480113810"
            newSky.SkyboxBk = "rbxassetid://17480111006"
        elseif theme == "Minecraft" then
            newSky.SkyboxUp = "rbxassetid://1876544642"
            newSky.SkyboxDn = "rbxassetid://1876544331"
            newSky.SkyboxLf = "rbxassetid://1876543392"
            newSky.SkyboxRt = "rbxassetid://1876543764"
            newSky.SkyboxFt = "rbxassetid://1876542941"
            newSky.SkyboxBk = "rbxassetid://1876545003"
        elseif theme == "Anime Island" then
            newSky.SkyboxUp = "rbxassetid://14753810287"
            newSky.SkyboxDn = "rbxassetid://14753795573"
            newSky.SkyboxLf = "rbxassetid://14753797417"
            newSky.SkyboxRt = "rbxassetid://14753799966"
            newSky.SkyboxFt = "rbxassetid://14753807625"
            newSky.SkyboxBk = "rbxassetid://14753804949"
        elseif theme == "Wide Street" then
            newSky.SkyboxUp = "rbxassetid://11805842108"
            newSky.SkyboxDn = "rbxassetid://11805844871"
            newSky.SkyboxLf = "rbxassetid://11805843612"
            newSky.SkyboxRt = "rbxassetid://11805841159"
            newSky.SkyboxFt = "rbxassetid://11805842926"
            newSky.SkyboxBk = "rbxassetid://11805845809"
        end
    end)

    return Button
end

for _, theme in ipairs(skyThemes) do
    CreateThemeButton(theme)
end

UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y + 20)
end)

CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)


local isDragging = false
local dragInput = nil
local dragStart = nil
local startPos = nil

local function updateDrag(input)
    local delta = input.Position - dragStart
    MainFrame.Position = UDim2.new(
        startPos.X.Scale,
        startPos.X.Offset + delta.X,
        startPos.Y.Scale,
        startPos.Y.Offset + delta.Y
    )
end

TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        isDragging = true
        dragStart = input.Position
        startPos = MainFrame.Position

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                isDragging = false
            end
        end)
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and isDragging then
        updateDrag(input)
    end
end)

TitleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)


TitleBar.TouchStarted:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch then
        isDragging = true
        dragStart = input.Position
        startPos = MainFrame.Position

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                isDragging = false
            end
        end)
    end
end)

UserInputService.TouchMoved:Connect(function(input)
    if isDragging and input.UserInputType == Enum.UserInputType.Touch then
        updateDrag(input)
    end
end)
