
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")


local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SkyThemeGUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = PlayerGui


local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 320, 0, 420)
MainFrame.Position = UDim2.new(0.5, -160, 0.5, -210)
MainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
MainFrame.BackgroundTransparency = 0.8
MainFrame.BorderColor3 = Color3.fromRGB(66, 133, 244)
MainFrame.BorderSizePixel = 2
MainFrame.Parent = ScreenGui

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 12)
MainCorner.Parent = MainFrame


local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Size = UDim2.new(1, 0, 0, 45)
TitleBar.Position = UDim2.new(0,0,0,0)
TitleBar.BackgroundColor3 = Color3.fromRGB(0,0,0)
TitleBar.BackgroundTransparency = 0.8
TitleBar.BorderColor3 = Color3.fromRGB(66,133,244)
TitleBar.BorderSizePixel = 2
TitleBar.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 12)
TitleCorner.Parent = TitleBar

local TitleText = Instance.new("TextLabel")
TitleText.Name = "TitleText"
TitleText.Size = UDim2.new(1, -60, 1, 0)
TitleText.Position = UDim2.new(0, 15, 0, 0)
TitleText.BackgroundTransparency = 1
TitleText.Text = "Sky Themes"
TitleText.TextColor3 = Color3.fromRGB(255,255,255)
TitleText.TextSize = 20
TitleText.Font = Enum.Font.GothamBold
TitleText.TextXAlignment = Enum.TextXAlignment.Left
TitleText.Parent = TitleBar


local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Size = UDim2.new(0, 35, 0, 35)
CloseButton.Position = UDim2.new(1, -45, 0, 5)
CloseButton.BackgroundColor3 = Color3.fromRGB(220, 70, 70)
CloseButton.Text = "✕"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 22
CloseButton.Font = Enum.Font.GothamBold
CloseButton.BorderSizePixel = 0
CloseButton.Parent = TitleBar

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 17)
CloseCorner.Parent = CloseButton


local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Parent = TitleBar
MinimizeButton.Text = "-"
MinimizeButton.Size = UDim2.new(0,30,0,30)
MinimizeButton.Position = UDim2.new(1,-85,0,5)
MinimizeButton.BackgroundColor3 = Color3.fromRGB(66,133,244)
MinimizeButton.TextColor3 = Color3.fromRGB(255,255,255)
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.TextSize = 20

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0,8)
MinCorner.Parent = MinimizeButton


local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Size = UDim2.new(1, -20, 1, -60)
ContentFrame.Position = UDim2.new(0, 10, 0, 50)
ContentFrame.BackgroundTransparency = 1 -- hollow effect
ContentFrame.BorderSizePixel = 0
ContentFrame.Parent = MainFrame

local ScrollFrame = Instance.new("ScrollingFrame")
ScrollFrame.Name = "ScrollFrame"
ScrollFrame.Size = UDim2.new(1, -10, 1, -10)
ScrollFrame.Position = UDim2.new(0, 5, 0, 5)
ScrollFrame.BackgroundTransparency = 1
ScrollFrame.BorderSizePixel = 0
ScrollFrame.ScrollBarThickness = 5
ScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(66, 133, 244)
ScrollFrame.Parent = ContentFrame

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 10)
UIListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Parent = ScrollFrame

local UIPadding = Instance.new("UIPadding")
UIPadding.PaddingTop = UDim.new(0, 12)
UIPadding.PaddingBottom = UDim.new(0, 12)
UIPadding.Parent = ScrollFrame


local ParticleContainer = Instance.new("Frame")
ParticleContainer.Parent = ContentFrame
ParticleContainer.BackgroundTransparency = 1
ParticleContainer.Size = UDim2.new(1,0,1,0)
ParticleContainer.ClipsDescendants = true

local particleTypes = {
    {shape = "♡", colors = {Color3.fromRGB(100,140,255), Color3.fromRGB(150,200,255), Color3.fromRGB(255,220,255)}},
    {shape = "★", colors = {Color3.fromRGB(200,255,255), Color3.fromRGB(255,240,255), Color3.fromRGB(180,200,255)}},
    {shape = "✧", colors = {Color3.fromRGB(100,180,255), Color3.fromRGB(150,220,255), Color3.fromRGB(200,255,255)}}
}

for i = 1, 15 do
    local particleType = particleTypes[math.random(1,#particleTypes)]
    local particleColor = particleType.colors[math.random(1,#particleType.colors)]
    local particle = Instance.new("TextLabel")
    particle.Parent = ParticleContainer
    particle.BackgroundTransparency = 1
    particle.Size = UDim2.new(0, math.random(15,25),0,math.random(15,25))
    particle.Position = UDim2.new(math.random(),0,math.random(),0)
    particle.Text = particleType.shape
    particle.TextColor3 = particleColor
    particle.TextSize = math.random(14,18)
    particle.TextTransparency = math.random(0,50)/100
    local tween = TweenService:Create(particle, TweenInfo.new(math.random(5,10),Enum.EasingStyle.Linear,Enum.EasingDirection.InOut,-1,true), {Position = UDim2.new(math.random(),0,math.random(),0)})
    tween:Play()
end


local skyThemes = {
    "CakeUP Night Galaxy Planets", "Purple Space", "Galaxy Mountains",
    "Deep Space", "Nebula", "Night", "Alien Red",
    "Tropical", "Day Clouds", "Minecraft", "Anime Island", "Wide Street"
}

local function CreateThemeButton(theme)
    local Button = Instance.new("TextButton")
    Button.Name = theme .. "_Button"
    Button.Size = UDim2.new(1, -20, 0, 40)
    Button.BackgroundColor3 = Color3.fromRGB(66,133,244)
    Button.Text = theme
    Button.TextColor3 = Color3.fromRGB(255,255,255)
    Button.TextSize = 14
    Button.Font = Enum.Font.GothamBold
    Button.BorderSizePixel = 0
    Button.Parent = ScrollFrame

    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0, 6)
    ButtonCorner.Parent = Button

    Button.MouseButton1Click:Connect(function()
        
        local existingSky = game.Lighting:FindFirstChildOfClass("Sky")
        if existingSky then
            existingSky:Destroy()
        end
       
        local newSky = Instance.new("Sky")
        newSky.Parent = game.Lighting
        if theme == "CakeUP Night Galaxy Planets" then
            newSky.SkyboxUp = "rbxassetid://15983964246"
            newSky.SkyboxDn = "rbxassetid://15983966825"
            newSky.SkyboxLf = "rbxassetid://15983967420"
            newSky.SkyboxRt = "rbxassetid://15983966246"
            newSky.SkyboxFt = "rbxassetid://15983965025"
            newSky.SkyboxBk = "rbxassetid://15983968922"
        elseif theme == "Purple Space" then
            newSky.SkyboxUp = "rbxassetid://14543371676"
            newSky.SkyboxDn = "rbxassetid://14543358958"
            newSky.SkyboxLf = "rbxassetid://14543275895"
            newSky.SkyboxRt = "rbxassetid://14543280890"
            newSky.SkyboxFt = "rbxassetid://14543257810"
            newSky.SkyboxBk = "rbxassetid://14543264135"
        elseif theme == "Galaxy Mountains" then
            newSky.SkyboxUp = "rbxassetid://17103639457"
            newSky.SkyboxDn = "rbxassetid://17103622190"
            newSky.SkyboxLf = "rbxassetid://17103628153"
            newSky.SkyboxRt = "rbxassetid://17103636666"
            newSky.SkyboxFt = "rbxassetid://17103624898"
            newSky.SkyboxBk = "rbxassetid://17103618635"
        elseif theme == "Deep Space" then
            newSky.SkyboxUp = "rbxassetid://159248176"
            newSky.SkyboxDn = "rbxassetid://159248183"
            newSky.SkyboxLf = "rbxassetid://159248173"
            newSky.SkyboxRt = "rbxassetid://159248192"
            newSky.SkyboxFt = "rbxassetid://159248187"
            newSky.SkyboxBk = "rbxassetid://159248188"
        elseif theme == "Nebula" then
            newSky.SkyboxUp = "rbxassetid://13581450222"
            newSky.SkyboxDn = "rbxassetid://13581439832"
            newSky.SkyboxLf = "rbxassetid://13581443463"
            newSky.SkyboxRt = "rbxassetid://13581452875"
            newSky.SkyboxFt = "rbxassetid://13581447312"
            newSky.SkyboxBk = "rbxassetid://13581437029"
        elseif theme == "Night" then
            newSky.SkyboxUp = "rbxassetid://12064131"
            newSky.SkyboxDn = "rbxassetid://12064152"
            newSky.SkyboxLf = "rbxassetid://12063984"
            newSky.SkyboxRt = "rbxassetid://12064115"
            newSky.SkyboxFt = "rbxassetid://12064121"
            newSky.SkyboxBk = "rbxassetid://12064107"
        elseif theme == "Alien Red" then
            newSky.SkyboxUp = "rbxassetid://1014449"
            newSky.SkyboxDn = "rbxassetid://1012891"
            newSky.SkyboxLf = "rbxassetid://1012889"
            newSky.SkyboxRt = "rbxassetid://1012888"
            newSky.SkyboxFt = "rbxassetid://1012887"
            newSky.SkyboxBk = "rbxassetid://1012890"
        elseif theme == "Tropical" then
            newSky.SkyboxUp = "rbxassetid://169210149"
            newSky.SkyboxDn = "rbxassetid://169210108"
            newSky.SkyboxLf = "rbxassetid://169210133"
            newSky.SkyboxRt = "rbxassetid://169210143"
            newSky.SkyboxFt = "rbxassetid://169210121"
            newSky.SkyboxBk = "rbxassetid://169210090"
        elseif theme == "Day Clouds" then
            newSky.SkyboxUp = "rbxassetid://17480119200"
            newSky.SkyboxDn = "rbxassetid://17480112104"
            newSky.SkyboxLf = "rbxassetid://17480115228"
            newSky.SkyboxRt = "rbxassetid://17480116763"
            newSky.SkyboxFt = "rbxassetid://17480113810"
            newSky.SkyboxBk = "rbxassetid://17480111006"
        elseif theme == "Minecraft" then
            newSky.SkyboxUp = "rbxassetid://1876544642"
            newSky.SkyboxDn = "rbxassetid://1876544331"
            newSky.SkyboxLf = "rbxassetid://1876543392"
            newSky.SkyboxRt = "rbxassetid://1876543764"
            newSky.SkyboxFt = "rbxassetid://1876542941"
            newSky.SkyboxBk = "rbxassetid://1876545003"
        elseif theme == "Anime Island" then
            newSky.SkyboxUp = "rbxassetid://14753810287"
            newSky.SkyboxDn = "rbxassetid://14753795573"
            newSky.SkyboxLf = "rbxassetid://14753797417"
            newSky.SkyboxRt = "rbxassetid://14753799966"
            newSky.SkyboxFt = "rbxassetid://14753807625"
            newSky.SkyboxBk = "rbxassetid://14753804949"
        elseif theme == "Wide Street" then
            newSky.SkyboxUp = "rbxassetid://11805842108"
            newSky.SkyboxDn = "rbxassetid://11805844871"
            newSky.SkyboxLf = "rbxassetid://11805843612"
            newSky.SkyboxRt = "rbxassetid://11805841159"
            newSky.SkyboxFt = "rbxassetid://11805842926"
            newSky.SkyboxBk = "rbxassetid://11805845809"
        end
    end)

    return Button
end

for _, theme in ipairs(skyThemes) do
    CreateThemeButton(theme)
end

UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    ScrollFrame.CanvasSize = UDim2.new(0,0,0,UIListLayout.AbsoluteContentSize.Y+20)
end)

CloseButton.MouseButton1Click:Connect(function()
    local fadeOut = TweenService:Create(ScreenGui, TweenInfo.new(0.4), {Enabled = false})
    fadeOut:Play()
end)


local dragging, dragInput, dragStart, startPos
TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

TitleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale,startPos.X.Offset+delta.X,startPos.Y.Scale,startPos.Y.Offset+delta.Y)
    end
end)


local minimized = false
local originalSize = MainFrame.Size
MinimizeButton.MouseButton1Click:Connect(function()
    if not minimized then
        originalSize = MainFrame.Size
        TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Quad), {Size = UDim2.new(originalSize.X.Scale, originalSize.X.Offset, 0, 50)}):Play()
        minimized = true
    else
        TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Quad), {Size = originalSize}):Play()
        minimized = false
    end
end)
